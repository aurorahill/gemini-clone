(()=>{"use strict";const e=document.querySelector(".typing-area__typing-form"),t=document.querySelector(".chat-list"),s=document.querySelectorAll(".header__suggestion"),a=document.querySelector("#toggle-theme-button"),n=document.querySelector("#delete-chat-button");let o=null,i=!1;const l=()=>{const e=localStorage.getItem("savedChats"),s="light_mode"===localStorage.getItem("themeColor");document.body.classList.toggle("light_mode",s),a.innerText=s?"dark_mode":"light_mode",t.innerHTML=e||"",document.body.classList.toggle("hide-header",e),t.scrollTo(0,t.scrollHeight)};l();const r=function(e){const t=document.createElement("div");for(var s=arguments.length,a=new Array(s>1?s-1:0),n=1;n<s;n++)a[n-1]=arguments[n];return t.classList.add("chat-list__message",...a),t.innerHTML=e,t},c=e=>{const t=e.target.parentElement.querySelector(".chat-list__text").innerText;navigator.clipboard.writeText(t),e.target.innerText="check",setTimeout((()=>e.target.innerText="content_copy"),1e3)},d=()=>{const e=r('<div class="chat-list__message-content">\n            <img\n              src="./images/gemini.svg"\n              alt="Gemini Image"\n              class="chat-list__avatar"\n            />\n            <p class="chat-list__text"></p>\n            <div class="chat-list__loading-indicator">\n              <div class="chat-list__loading-bar"></div>\n              <div class="chat-list__loading-bar"></div>\n              <div class="chat-list__loading-bar"></div>\n            </div>\n          </div>\n          <span class="chat-list__icon material-symbols-rounded">\n            content_copy\n          </span>',"chat-list__incoming","chat-list__loading");t.appendChild(e),(async e=>{const s=e.querySelector(".chat-list__text");try{const a=await fetch("https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent?key=your API_KEY",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{role:"user",parts:[{text:o}]}]})}),n=await a.json();if(!a.ok)throw new Error(n.error.message);const l=n?.candidates[0].content.parts[0].text.replace(/\*\*(.*?)\*\*/g,"$1");((e,s,a)=>{const n=e.split(" ");let o=0;const l=setInterval((()=>{s.innerText+=(0===o?"":" ")+n[o++],a.querySelector(".chat-list__icon").classList.add("hide"),o===n.length&&(clearInterval(l),i=!1,a.querySelector(".chat-list__icon").classList.remove("hide"),localStorage.setItem("savedChats",t.innerHTML)),t.scrollTo(0,t.scrollHeight)}),75)})(l,s,e)}catch(e){i=!1,console.log(e.message),"API key not valid. Please pass a valid API key."===e.message?(s.innerText="I swear, it works! You need to download your api key from https://aistudio.google.com and paste it into index.js file in the API_KEY variable. Error message: API key not valid. Please pass a valid API key.",s.classList.add("error")):(s.innerText=e.message,s.classList.add("error"))}finally{e.classList.remove("chat-list__loading")}})(e),t.scrollTo(0,t.scrollHeight),t.querySelectorAll(".chat-list__icon").forEach((e=>{e.addEventListener("click",c)}))},g=()=>{if(o=e.querySelector(".typing-area__typing-input").value.trim()||o,!o||i)return;i=!0;const s=r('<div class="chat-list__message-content">\n          <img\n            src="./images/user.png"\n            alt="User Image"\n            class="chat-list__avatar"\n          />\n          <p class="chat-list__text"></p>\n        </div>',"chat-list__outgoing");s.querySelector(".chat-list__text").innerText=o,t.appendChild(s),e.reset(),t.scrollTo(0,t.scrollHeight),document.body.classList.add("hide-header"),setTimeout(d,400)};s.forEach((e=>{e.addEventListener("click",(()=>{o=e.querySelector(".header__suggestion-text").innerText,g()}))})),a.addEventListener("click",(()=>{const e=document.body.classList.toggle("light_mode");localStorage.setItem("themeColor",e?"light_mode":"dark_mode"),a.innerText=e?"dark_mode":"light_mode"})),n.addEventListener("click",(()=>{document.body.classList.contains("hide-header")&&confirm("Are you sure you want to delete all messages?")&&(localStorage.removeItem("savedChats"),l(),document.body.classList.remove("hide-header"))})),document.querySelector(".typing-area__typing-input").addEventListener("keydown",(e=>{13===e.keyCode&&document.querySelector("#send-button").click()})),e.addEventListener("submit",(e=>{e.preventDefault(),g()}))})();